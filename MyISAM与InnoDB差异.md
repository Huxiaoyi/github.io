
# MyISAM与InnoDB差异
## 事务：
MyIASM不支持事务，InnoDB支持事务；
## 锁粒度：
MyIASM锁的粒度是表级的，InnoDB支持行级锁，一般情况下写操作不锁定全表，在并发较高时，使用Innodb引擎会提升效率；

## 索引：
MyISAM和InnoDB都使用B+树来实现索引
### MyISAM的索引：
①. MyISAM的索引与数据分开存储的(即有连续聚集的区域单独存储行记录)，叫做非聚集索引; 
<br/>②. MyISAM的索引的叶子存储记录行指针; 所以其主键索引与普通索引没有本质差异：
<br/>③. 主键索引的叶子节点，存储主键，与对应行记录的指针；普通索引的叶子结点，存储索引列，与对应行记录的指针；
<br/>④. 主键索引与普通索引是两棵独立的索引B+树，通过索引列查找时，先定位到B+树的叶子节点，再通过指针定位到行记录。
<br/>⑤. MyIASM支持全文类型索引，InnoDB不支持全文索引；

### InnoDB的索引
<br/>①. InnoDB的主键索引与行记录是存储在一起的(即没有单独区域存储行记录)，叫做聚集索引：
<br/>②. InnoDB的表必须要有聚集索引：如果表定义了PK，则PK就是聚集索引；如果表没有定义PK，则第一个非空unique列是聚集索引；否则，InnoDB会创建一个隐藏的row-id作为聚集索引；
<br/>③. 聚集索引有且只有一个，因为数据行在物理磁盘上只能有一份聚集存储；且聚集索引和数据行统一存储；
<br/>④. 主键索引的叶子节点，存储主键和对应行记录（而不是指针）；
<br/>⑤. InnoDB普通索引可以有多个，它与聚集索引是不同的：普通索引的叶子节点，存储主键（也不是指针），所以普通索引通常需要回表；
<br/>⑥. InnoDB不支持哈希索引：InnoDB支持的哈希索引是自适应的，InnoDB存储引擎会根据表的使用情况自动为表生成哈希索引，不能认为干预是否在一张表中生成哈希索引；

### MyISAM和InnoDB索引总结
①. MyISAM和InnoDB都使用B+树来实现索引：
<br/>②. MyISAM的索引与数据分开存储
<br/>③. MyISAM的索引叶子存储指针，主键索引与普通索引无太大区别
<br/>④. InnoDB的聚集索引和数据行统一存储
<br/>⑤. InnoDB的聚集索引叶子存储数据行本身，普通索引叶子存储主键
<br/>⑥. InnoDB一定有且只有一个聚集索引
<br/>⑦. InnoDB建议使用趋势递增整数作为PK，而不宜使用较长的列作为PK

## 其他：
MyIASM中存储了表的行数(当SELECT语句有WHERE条件时,也需要全表扫描)，InnoDB需要全表扫描；

## 索引题外话：
①. 数据库索引用于加速查询
<br/>②. 虽然哈希索引是O(1)，树索引是O(log(n))，但SQL有很多“有序”需求，故数据库使用树型索引
<br/>③. 数据预读的思路是：磁盘读写并不是按需读取，而是按页预读，一次会读一页的数据，每次加载更多的数据，以便未来减少磁盘IO
<br/>④. 局部性原理：软件设计要尽量遵循“数据读取集中”与“使用到一个数据，大概率会使用其附近的数据”，这样磁盘预读能充分提高磁盘IO
<br/>⑤. 数据库的索引最常用B+树原因：
<br/>&nbsp;&nbsp;&nbsp;(1). 很适合磁盘存储，能够充分利用局部性原理，磁盘预读；
<br/>&nbsp;&nbsp;&nbsp;(2). 很低的树高度，能够存储大量数据；
<br/>&nbsp;&nbsp;&nbsp;(3). 索引本身占用的内存很小；
<br/>&nbsp;&nbsp;&nbsp;(4). 能够很好的支持单点查询，范围查询，有序性查询；